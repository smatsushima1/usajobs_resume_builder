<!DOCTYPE html>
<html lang="en">
    <head>
        <title>USAJobs Resume Converter</title>
        <meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
        <script type="text/javascript" src="src/script.js"></script>
        <link href="src/css_sheet.css" rel="stylesheet">
        <link rel="stylesheet" href="https://pyscript.net/latest/pyscript.css" />
        <script defer src="https://pyscript.net/latest/pyscript.js"></script>
        <py-config type="toml">
            packages = ["requests", "beautifulsoup4", "ssl", "openssl"]
            
            [[fetch]]
            files = ["/src/functions.py"]
            
        </py-config>
    </head>
    <main>
        <section>
            <h1 align="center">USAJobs Resume Converter</h1>
            <p>
            <b>Instructions:<br>1.</b> Input the resume to be edited in the left box. Bullet points and separate paragrahs can be used to organize everything, and are encouraged.<br><b>2</b>. Click the "Convert Text" button on the bottom of the left box to convert the resume to a blob of text in the right box. Unfortunately, USAJobs will do this to all resumes regardless.<br><b>3.</b> The converted resume can be edited and the character count on the botttom of the right box will update as edits are typed - one must keep in mind the 5,000 character limit.<br><b>4.</b> When finished, one can use the "Copy Text to Clipboard" button to copy all the text to be pasted into a USAJobs resume, and/or one can download the text into a .txt file.
            </p>
            <p>
                <label>USAJobs Posting: </label>
                <input type="text" id="posting">
                <button id="b_posting" py-onClick="print_dev('ughderpicus')">Load Data From Posting</button><br><br>
                Job Title: <label id="jt">2</label><br>
                Department: <label id="dt"></label><br>
                Organization: <label id="ot"></label><br>
                Duties: <label id="ad"></label><br>
                <py-script>
                    from bs4 import BeautifulSoup as bsp
                    import requests
                    from js import pullAddress
                    
                    def pull_posting():
                        hres = requests.get(pullAddress()).text
                        soup = bsp(hres, 'html.parser')
                        # Parse job title
                        banner = soup.find('div', {'class': 'usajobs-joa-banner__body usajobs-joa-banner--pilot__body'})
                        jtitle = banner.find('h1').text.strip()
                        dtitle = banner.find('h5', {'class': 'usajobs-joa-banner__dept'}).text.strip()
                        otitle = banner.find('h5', {'class': 'usajobs-joa-banner__hiring-organization'}).text.strip()
                        # Parse all duties
                        dsection = soup.find('div', {'id': 'duties'})
                        duties = dsection.find_all('li')
                        all_duties = ''
                        for i in duties:
                            all_duties += '- ' + i.text + '\n'
                        # Add all data
                        display(jtitle, target='jt')
                        display(dtitle, target='dt')
                        display(otitle, target='ot')
                        display(all_duties, target='ad')
                </py-script>
                <!-- Not sure whether Element().write is better or display()
                <py-script>
                    x = "nope"
                    display(x, target='l2')
                    Element('l1').write('ugh derp')
                    Element('l2').write('ugh derp')
                </py-script>
                -->
            </p>
            <div class="row">
                <div class="column" style="background-color:#aaa;">
                    <h3>Input Resume Here</h3>
                    <p>
                        <textarea title="Input Resume Here" id="resume_text"></textarea><br>
                        <button id="b_convert" onclick="convertText()">Convert Text</button>
                    </p>
                </div>
                <div class="column" style="background-color:#bbb;">
                    <h3>Converted USAJobs Resume</h3>
                    <p>
                        <textarea title="Converted Resume Appears Here" id="final_text" oninput="updateTotal()"></textarea><br>
                        <b>Characters: </b><label id="counter">0000</label>/5000<br>
                        <button id="b_copy" onclick="copyText()">Copy Text to Clipboard</button><br>
                        <button id="b_export" onclick="exportText()">Download Text as .txt File</button>
                    </p>
                </div>
            </div>
        </section>
    </main>
    <footer>
        <p>
            This is distributed under the terms of the <a href="http://www.gnu.org/licenses/gpl.txt">GNU General Public License</a>.
        </p>
    </footer>
</html>
